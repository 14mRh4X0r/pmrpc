    <script src="http://www.json.org/json2.js" type="text/javascript"></script>
    <script src="pmrpc.js" type="text/javascript"></script>

    <input type="button" onClick="startIframe();" value="Start server"/>
    <div id="ServerOutput"></div>

    <script type="text/javascript">
      function output(debugText) {
        var outputText = document.getElementById("ServerOutput").innerHTML;
        document.getElementById("ServerOutput").innerHTML = outputText + "<p>" + debugText + "</p>";
      }
    
      function startIframe() {
        // check if browser is postMessage compatible
        if (typeof window.postMessage === "undefined") {
          output("Your browser doesn't support the HTML5 postMessage API.");
          return;
        }
        
	output("Starting server");

        // test1
        pmrpc.register( {
          publicProcedureName : "test1",
          procedure : function() {} } );
        
        // test2
        pmrpc.register( {
          publicProcedureName : "test2", 
          procedure : function(echo) {return echo;} });
        
        // test3
        pmrpc.register( {
          publicProcedureName : "test3", 
          procedure : function() {} });
        
        // test4
        pmrpc.register( {
          publicProcedureName : "test4_unregistered", 
          procedure : function() {} });
        
        // test6
        pmrpc.register( {
          publicProcedureName : "test6", 
          procedure : function() {} });
        
        // test7
        pmrpc.register( {
          publicProcedureName : "test7", 
          procedure : function() {} });
        
        // test8
        pmrpc.register( {
          publicProcedureName : "test8", 
          procedure : function() {}, 
          acl : {whitelist: ["http://www.gmodules*","file://*"], blacklist:[]} });
        
        // test9
        pmrpc.register( {
          publicProcedureName : "test9", 
          procedure : function() {}, 
          acl : {whitelist: ["http://www.gmodules*", "file://*"], blacklist:["http://www.gmodules*", "file*"]} });
        
        // test10
        pmrpc.register( {
          publicProcedureName : "test10", 
          procedure : function() {}, 
          acl : {whitelist: ["http://www.fail.com*"], blacklist:[]} });
        
        // test11
        pmrpc.register( {
          publicProcedureName : "test11", 
          isAsynchronous : true,
          procedure : function(cb) {
            var doSomeMath = 2;
            cb(doSomeMath); } } );

	output("Starting started");
      }
    </script>
    
